# 更新日志

所有重要的变更都会记录在这个文件中。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
并且本项目遵循 [语义化版本](https://semver.org/lang/zh-CN/)。

## [6.0.0] - 2024-07-30

### 新增
- 🎉 **超长页面分块处理**：智能处理超过65000像素的长页面，突破PIL图像尺寸限制
- ✨ **PIL限制检测**：自动检测图像总高度是否超过PIL的65500像素限制
- ✨ **智能分块机制**：将超长图像分割为多个60000像素高度的安全块
- ✨ **Wikipedia完美支持**：完美支持Wikipedia等超长文章页面（如Apple Inc.页面，69000+像素）
- ✨ **分块文件管理**：自动生成和清理分块图像文件
- ✨ **长文章测试**：新增专门的长文章处理测试功能
- ✨ **超大图像测试**：新增超大图像处理功能测试

### 优化
- ⚡ **内存优化**：分块处理避免内存溢出和图像处理错误
- ⚡ **处理效率**：优化超长页面的处理流程和性能
- ⚡ **错误恢复**：改进图像处理错误的恢复机制
- ⚡ **用户体验**：显示分块处理进度和状态信息
- ⚡ **文件清理**：增强自动清理功能，包括分块文件清理

### 修复
- 🐛 **图像尺寸限制错误**：修复"Maximum supported image dimension"错误
- 🐛 **内存溢出问题**：修复处理超长页面时的内存溢出问题
- 🐛 **PDF生成失败**：修复超长图像PDF生成失败的问题
- 🐛 **临时文件堆积**：修复分块处理时临时文件未清理的问题

### 技术改进
- 🔧 **分块算法**：实现智能分块算法，确保内容完整性
- 🔧 **图像处理**：优化图像拼接和分块处理逻辑
- 🔧 **错误处理**：增强图像处理异常的捕获和处理
- 🔧 **测试框架**：扩展测试框架，支持长文章和超大图像测试

### 测试
- ✅ **长文章测试**：Wikipedia Apple Inc.页面测试（69372px高度）
- ✅ **超大图像测试**：Python编程语言页面测试（43337px高度）
- ✅ **分块处理验证**：验证分块处理的正确性和完整性
- ✅ **性能测试**：测试超长页面的处理性能和内存使用
- ✅ **清理功能测试**：验证分块文件的自动清理功能

### 文档
- 📚 **README更新**：添加长页面分块处理的详细说明
- 📚 **使用示例**：提供Wikipedia长文章处理示例
- 📚 **故障排除**：添加超长页面处理的故障排除指南
- 📚 **性能说明**：更新性能说明，包括超长页面处理时间

### 已知限制
- ⚠️ **处理时间**：超长页面（如Wikipedia文章）处理时间较长（3-10分钟）
- ⚠️ **内存需求**：建议8GB以上内存用于处理超长页面
- ⚠️ **磁盘空间**：超长页面生成的RTF文件可能较大（100KB-1MB）

## [1.0.0] - 2024-07-30

### 新增
- 🎉 **v1.0 稳定版本发布**
- ✨ **智能内容截图功能**：自动隐藏header、footer、导航栏等固定元素
- ✨ **RTF文档生成**：自动转换为可搜索的RTF格式，替代PDF输出
- ✨ **OCR文本识别**：使用EasyOCR AI技术识别图片中的文本内容
- ✨ **直接文本提取**：从HTML DOM中直接提取文本，保持原始结构
- ✨ **智能文本合并**：结合直接文本提取和OCR识别，确保内容完整性
- ✨ **并行处理支持**：同时处理多个URL，大幅提升处理效率
- ✨ **无限制截图**：移除截图数量限制，支持任意长度的页面
- ✨ **智能预估功能**：显示页面总高度和预估处理时间
- ✨ **自动清理机制**：程序结束或中断时自动清理临时文件
- ✨ **完善的错误处理**：网络超时保护、页面加载失败重试
- ✨ **命令行优化**：纯命令行版本，专注于核心功能

### 优化
- ⚡ **性能优化**：1000px步长，平衡截图质量和处理速度
- ⚡ **内存管理**：优化内存使用，支持大页面处理
- ⚡ **文件管理**：防止临时文件堆积，自动清理机制
- ⚡ **用户体验**：实时显示处理进度和状态信息
- ⚡ **文本处理**：智能合并直接文本提取和OCR结果
- ⚡ **格式保留**：保持标题、段落、列表等结构

### 修复
- 🐛 **网络连接问题**：改进网络超时处理和重试机制
- 🐛 **页面高度检测**：修复某些页面的高度检测问题
- 🐛 **临时文件清理**：确保程序异常退出时也能清理临时文件
- 🐛 **并行处理稳定性**：修复多线程处理中的竞态条件
- 🐛 **OCR识别准确性**：优化OCR参数，提高文本识别准确率

### 技术改进
- 🔧 **依赖更新**：更新到最新的selenium、webdriver-manager、pillow版本
- 🔧 **新增依赖**：添加pytesseract和easyocr用于OCR功能
- 🔧 **代码重构**：优化代码结构，提高可维护性
- 🔧 **测试覆盖**：添加全面的测试用例，确保功能稳定性
- 🔧 **文档完善**：更新README文档，添加详细的使用说明

### 测试
- ✅ **全面测试通过**：所有测试用例100%通过
- ✅ **功能验证**：单个URL处理、多个URL并行处理
- ✅ **错误处理测试**：无效URL处理、网络错误处理
- ✅ **性能测试**：长页面处理、内存使用测试
- ✅ **OCR测试**：文本识别准确性测试

### 文档
- 📚 **README更新**：添加详细的功能说明和使用示例
- 📚 **安装指南**：提供完整的安装和配置说明
- 📚 **故障排除**：添加常见问题和解决方案
- 📚 **性能说明**：详细说明性能特性和系统要求
- 📚 **OCR说明**：添加OCR功能的使用说明和注意事项

## 早期版本历史

### v5.0 (开发版本)
- 纯命令行版本：移除所有Web界面和API功能
- 简化架构：专注于命令行使用体验
- 并行处理：支持同时处理多个URL
- 智能去重：自动隐藏固定元素
- 无限制截图：支持任意长度页面

### v4.0 (开发版本)
- 多用户API：支持多用户并发处理
- 用户隔离：不同用户的任务完全隔离
- API接口：提供完整的RESTful API接口
- 并发处理：支持多个用户同时使用系统
- 状态管理：实时跟踪每个用户的任务状态
- 点对点下载：每个URL都有独立的PDF和下载链接

### v3.0 (开发版本)
- Web界面：提供友好的Web界面，支持多URL批量处理
- 并行处理：使用多线程技术，同时处理多个URL
- 实时进度：Web界面显示实时处理进度和状态
- 自动下载：处理完成后自动提供PDF下载链接
- 错误处理：显示详细的错误信息和处理状态

### v2.0 (开发版本)
- 智能去重：自动隐藏header、footer等固定元素
- 内容优化：只截取页面主要内容，避免重复
- 无限制截图：移除15张截图限制，支持任意长度页面
- 智能预估：显示页面总高度和预估处理时间
- 步长优化：1000px步长，确保内容连贯
- 性能优化：优化处理流程，提升截图质量

### v1.0 (初始版本)
- 基础网页截图功能
- PDF生成和拼接 